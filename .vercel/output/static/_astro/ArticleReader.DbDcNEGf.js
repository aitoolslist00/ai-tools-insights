import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.Cd_vQiNd.js";function M(){const[d,p]=r.useState([]),[x,v]=r.useState(""),[a,y]=r.useState(0),[u,o]=r.useState(!1),[m,w]=r.useState(0),j=r.useRef(null);r.useEffect(()=>{const t=document.querySelector("article")||document.querySelector(".article-content");if(j.current=t,!t)return;const n=t.querySelectorAll("h1, h2, h3, h4, h5, h6"),h=Array.from(n).map((s,l)=>{const i=s.id||`heading-${l}`;return s.id||(s.id=i),{id:i,text:s.textContent||"",level:parseInt(s.tagName[1])}});p(h);const c=t.textContent?.trim().split(/\s+/).length||0,k=Math.ceil(c/200);w(k);const N={rootMargin:"-80px 0px -80% 0px",threshold:0},f=new IntersectionObserver(s=>{s.forEach(l=>{l.isIntersecting&&v(l.target.id)})},N);n.forEach(s=>{f.observe(s)});const b=()=>{if(!t)return;t.getBoundingClientRect().top;const s=t.scrollHeight,l=window.innerHeight,i=window.scrollY-(t.offsetTop-l),C=Math.min(Math.max(i/(s-l)*100,0),100);y(C)};return window.addEventListener("scroll",b),()=>{f.disconnect(),window.removeEventListener("scroll",b)}},[]);const g=t=>{const n=document.getElementById(t);if(n){const c=n.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:c-100,behavior:"smooth"}),o(!1)}};return d.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block fixed left-4 top-1/2 -translate-y-1/2 z-40 w-56",children:e.jsxs("div",{className:"glass-morphism rounded-2xl p-4 shadow-2xl max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-sm uppercase tracking-wider text-gray-700 dark:text-gray-300",children:"Table of Contents"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[m," min read"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${a}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Math.round(a),"% completed"]})]}),e.jsx("nav",{className:"space-y-1",children:d.map(t=>e.jsx("button",{onClick:()=>g(t.id),className:`block w-full text-left px-3 py-2 rounded-lg transition-all text-sm ${x===t.id?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,style:{paddingLeft:`${(t.level-1)*12+12}px`},children:t.text},t.id))})]})}),e.jsx("button",{onClick:()=>o(!u),className:"lg:hidden fixed bottom-24 left-4 p-4 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-4 focus:ring-blue-500/50 z-40","aria-label":"Toggle table of contents",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})})}),u&&e.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 flex items-end sm:items-center justify-center px-4 animate-fade-in",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>o(!1)}),e.jsxs("div",{className:"relative w-full max-w-md glass-morphism rounded-2xl shadow-2xl p-6 max-h-[80vh] overflow-y-auto animate-slide-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Table of Contents"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx("span",{children:"Reading Progress"}),e.jsxs("span",{children:[m," min read"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 h-2 rounded-full transition-all duration-300",style:{width:`${a}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-center",children:[Math.round(a),"% completed"]})]}),e.jsx("nav",{className:"space-y-1",children:d.map(t=>e.jsx("button",{onClick:()=>g(t.id),className:`block w-full text-left px-3 py-2 rounded-lg transition-all ${x===t.id?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,style:{paddingLeft:`${(t.level-1)*12+12}px`},children:t.text},t.id))})]})]}),e.jsx("div",{className:"fixed top-16 left-0 right-0 h-1 bg-gray-200 dark:bg-gray-800 z-[45]",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 transition-all duration-150",style:{width:`${a}%`}})})]})}export{M as default};
